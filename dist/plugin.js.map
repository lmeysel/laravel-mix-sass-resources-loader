{"version":3,"sources":["../src/plugin.js"],"names":[],"mappings":"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","file":"plugin.js","sourcesContent":["const mix = require('laravel-mix');\nconst path = require('path');\nconst fs = require('fs');\n\nlet mix4 = true;\nfs.readFile(path.resolve(process.cwd(), 'node_modules/laravel-mix/package.json'), { encoding: 'utf8' }, (err, data) => {\n\tconst v = JSON.parse(data)['version'];\n\tmix4 = /^4\\./.test(v);\n});\n\nconst ext = new class {\n\tregister(...args) {\n\t\tif (!this.resources) this.resources = [];\n\t\targs.forEach(a => a instanceof Array ?\n\t\t\tthis.resources.push.apply(this.resources, a.map(r => path.resolve(process.cwd(), r))) :\n\t\t\tthis.resources.push(path.resolve(process.cwd(), a)));\n\t}\n\tdependencies() { return ['sass-resources-loader']; }\n\n\twebpackConfig(config) {\n\t\tconst rules = config.module.rules.filter(rule =>\n\t\t\t((rule.test instanceof RegExp) && rule.test.test('asdf.scss'))\n\t\t\t|| (typeof (rule.test) === 'string' && /\\.s[ac]ss$/.test(rule.test)));\n\n\t\tconst ldr = { loader: 'sass-resources-loader', options: { resources: this.resources } };\n\t\tif (mix4)\n\t\t\trules.forEach(rule => {\n\t\t\t\tif (rule.loaders) {\n\t\t\t\t\trule.use = rule.loaders;\n\t\t\t\t\tdelete rule.loaders;\n\t\t\t\t}\n\t\t\t\trule.use.push(ldr)\n\t\t\t});\n\t\telse {\n\t\t\trules.forEach(rule => {\n\t\t\t\tif (rule.loaders) {\n\t\t\t\t\trule.use = rule.loaders.map(loader => ({ loader }));\n\t\t\t\t\tdelete rule.loaders;\n\t\t\t\t}\n\t\t\t\trule.use.push(ldr)\n\t\t\t});\n\t\t\t// vue loader\n\t\t\tconst rule = config.module.rules.find(rule => (rule.test instanceof RegExp && rule.test.test('asdf.vue')));\n\t\t\t['sass', 'scss'].forEach(st => {\n\t\t\t\tif (!rule.options.loaders[st])\n\t\t\t\t\trule.options.loaders[st] = ['style-loader', 'css-loader', 'sass-loader', ldr];\n\t\t\t\telse rule.options.loaders[st].push(ldr);\n\t\t\t});\n\n\t\t}\n\t}\n}();\n\nmix.extend('sassResources', ext);"]}